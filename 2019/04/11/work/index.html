<!DOCTYPE html>
<html>
    <head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="/styles/main.css">
    </head>
    <body>
        <div class="container">
            <header>
<div class="main">
<div class="title">
    <a href="#" class="logo">Bacbin&#39;s blogs</a>
</div>
<div class="site-nav">
    <ul id="menu" class="menu">
    
        <li class="menu-item text-underline">
            <a href="/">Home</a>
        </li>
    
        <li class="menu-item text-underline">
            <a href="/archives">Archives</a>
        </li>
    
        <li class="menu-item text-underline">
            <a href="/about/">About</a>
        </li>
            
    </ul>
</div>
</div>
</header>
            <main class="main">
                <section class="posts clearfix">
<div class="post-wrapper">
    <article class="post article-entry">
    <div class="post-title">
        PyData
    </div>
    <p class="sub">Apr 11 2019</p>
    <div class="post-content">
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#引入头文件</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#读取文件</span></span><br><span class="line">dframe = pd.read_excel(<span class="string">"iii.xlsx"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#康一康文件</span></span><br><span class="line">dframe.head()</span><br></pre></td></tr></table></figure>
<div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>型号</th><br>      <th>is_paused</th><br>      <th>长（米）</th><br>      <th>高（米）</th><br>      <th>翼展（米）</th><br>      <th>直径（米）</th><br>      <th>引擎型号</th><br>      <th>正常引擎推力（千克力）</th><br>      <th>最大起飞重量（kg）</th><br>      <th>最大载重（kg）</th><br>      <th>…</th><br>      <th>容积（立方米）</th><br>      <th>设计寿命（年）</th><br>      <th>设计寿命（飞行小时）</th><br>      <th>设计寿命（起降次数）</th><br>      <th>座位数（典型两舱座位布局）</th><br>      <th>起飞速度（m/s）</th><br>      <th>飞行高度</th><br>      <th>坠机时间/year</th><br>      <th>坠落时间/month</th><br>      <th>坠落时间/day</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>IL-76TD</td><br>      <td>0</td><br>      <td>46.60</td><br>      <td>14.76</td><br>      <td>50.50</td><br>      <td>4.8</td><br>      <td>4 X D-30KP-ser.2</td><br>      <td>4 X 12000</td><br>      <td>190000</td><br>      <td>50000.0</td><br>      <td>…</td><br>      <td>321</td><br>      <td>20.0</td><br>      <td>30000.0</td><br>      <td>10000.0</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>2016</td><br>      <td>7</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>737 MAX8</td><br>      <td>1</td><br>      <td>39.47</td><br>      <td>12.30</td><br>      <td>35.90</td><br>      <td>NaN</td><br>      <td>LEAP-1B</td><br>      <td>NaN</td><br>      <td>82191</td><br>      <td>20882.0</td><br>      <td>…</td><br>      <td>43.6</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>138 – 153</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>2019</td><br>      <td>10</td><br>      <td>3</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>Antonov An-148-100B</td><br>      <td>0</td><br>      <td>29.13</td><br>      <td>8.19</td><br>      <td>28.91</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>41950</td><br>      <td>9000.0</td><br>      <td>…</td><br>      <td>14.6</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>2011</td><br>      <td>3</td><br>      <td>15</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>ATR 72-212</td><br>      <td>0</td><br>      <td>27.20</td><br>      <td>7.65</td><br>      <td>27.05</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>22500</td><br>      <td>NaN</td><br>      <td>…</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>2010</td><br>      <td>11</td><br>      <td>4</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>DHC-8*402Q Dash 8</td><br>      <td>1</td><br>      <td>22.25</td><br>      <td>7.49</td><br>      <td>25.91</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>15650</td><br>      <td>NaN</td><br>      <td>…</td><br>      <td>45.3</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>NaN</td><br>      <td>2009</td><br>      <td>2</td><br>      <td>12</td><br>    </tr><br>  </tbody><br></table><br><p>5 rows × 30 columns</p><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#康一康属性，object类型的一律不要，非int、float没法建模</span></span><br><span class="line">dframe.dtypes</span><br></pre></td></tr></table></figure>
<pre><code>型号                object
is_paused          int64
长（米）             float64
高（米）             float64
翼展（米）            float64
直径（米）            float64
引擎型号              object
正常引擎推力（千克力）       object
最大起飞重量（kg）        object
最大载重（kg）         float64
燃油（升）            float64
巡航速度（千米/时）       float64
巡航高度（米）           object
航程                 int64
满载起飞跑道长（米）        object
满载着陆跑道长（米）       float64
成员（含装卸员、炮手）      float64
货舱长度（米）          float64
货舱出口高度（米）        float64
货舱甲板宽度（米）        float64
容积（立方米）           object
设计寿命（年）          float64
设计寿命（飞行小时）       float64
设计寿命（起降次数）       float64
座位数（典型两舱座位布局）     object
起飞速度（m/s）        float64
飞行高度             float64
坠机时间/year          int64
坠落时间/month         int64
坠落时间/day           int64
dtype: object
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">dframe[<span class="string">'长（米）'</span>].values</span><br><span class="line"><span class="comment">#剔除一些object类型的属性</span></span><br><span class="line">drop1 = [<span class="string">'is_paused'</span>,<span class="string">'型号'</span>,<span class="string">'直径（米）'</span>,<span class="string">'引擎型号'</span>,<span class="string">'正常引擎推力（千克力）'</span>,<span class="string">'最大起飞重量（kg）'</span>,<span class="string">'满载起飞跑道长（米）'</span>,<span class="string">'容积（立方米）'</span>,<span class="string">'座位数（典型两舱座位布局）'</span>,<span class="string">'起飞速度（m/s）'</span>,<span class="string">'飞行高度'</span>]</span><br><span class="line">x_columns = [x <span class="keyword">for</span> x <span class="keyword">in</span> dframe.columns <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> drop1]</span><br><span class="line"><span class="comment">#剔除一些空值过多的属性</span></span><br><span class="line">drop2 = [<span class="string">'最大载重（kg）'</span>,<span class="string">'燃油（升）'</span>,<span class="string">'巡航高度（米）'</span>,<span class="string">'满载着陆跑道长（米）'</span>,<span class="string">'成员（含装卸员、炮手）'</span>,<span class="string">'货舱长度（米）'</span>,<span class="string">'货舱出口高度（米）'</span>,<span class="string">'货舱甲板宽度（米）'</span>,<span class="string">'设计寿命（年）'</span>,<span class="string">'设计寿命（飞行小时）'</span>,<span class="string">'设计寿命（起降次数）'</span>]</span><br><span class="line">x_columns2 = [x <span class="keyword">for</span> x <span class="keyword">in</span> x_columns <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> drop2]</span><br><span class="line">x = dframe[x_columns2]</span><br><span class="line"><span class="comment">#较少空值的用该列均值替代</span></span><br><span class="line">mean = x[<span class="string">'巡航速度（千米/时）'</span>].mean()</span><br><span class="line">mean1 = x[<span class="string">'高（米）'</span>].mean()</span><br><span class="line">x[<span class="string">'高（米）'</span>].fillna(mean1,inplace=<span class="keyword">True</span>)</span><br><span class="line">x[<span class="string">'巡航速度（千米/时）'</span>].fillna(mean,inplace=<span class="keyword">True</span>)</span><br><span class="line"><span class="comment">#x['巡航速度（千米/时）']</span></span><br><span class="line"><span class="comment">#x['巡航速度（千米/时）'].mean()</span></span><br><span class="line">x[<span class="string">'航程'</span>]</span><br></pre></td></tr></table></figure>
<pre><code>/anaconda3/lib/python3.6/site-packages/pandas/core/generic.py:3660: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self._update_inplace(new_data)





0      4900
1      6570
2      2100
3      2092
4      2038
5        40
6      2500
7      1400
8     13400
9      2500
10     3800
11     4800
12     1680
13      926
14     3340
15     2600
16     6652
17     3417
18     5000
19     2040
20     4348
21     1964
22     5700
23     1030
24     3600
25     1352
26     4074
27     1344
28     4461
Name: 航程, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#画图测试</span></span><br><span class="line">sns.set_style(<span class="string">"whitegrid"</span>) </span><br><span class="line">fig, axes = plt.subplots(<span class="number">1</span>,<span class="number">2</span>)  </span><br><span class="line">sns.distplot(x[<span class="string">'Length'</span>], ax = axes[<span class="number">0</span>], kde = <span class="keyword">True</span>, rug = <span class="keyword">True</span>)        <span class="comment"># kde 密度曲线  rug 边际毛毯  </span></span><br><span class="line">sns.kdeplot(x[<span class="string">'Length'</span>], ax = axes[<span class="number">1</span>], shade=<span class="keyword">True</span>)                     <span class="comment"># shade  阴影                         </span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="output_5_0.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#y值，即因变量</span></span><br><span class="line">y = dframe[<span class="string">'is_paused'</span>]</span><br><span class="line"><span class="comment">#y = y.where(y.notnull(), 0)</span></span><br><span class="line"><span class="comment">#Series转Dataframe</span></span><br><span class="line">y = y.to_frame()</span><br><span class="line"><span class="comment">#判断类型</span></span><br><span class="line">isinstance(y, pd.Series)</span><br><span class="line"></span><br><span class="line"><span class="comment">#康康x</span></span><br><span class="line">x</span><br></pre></td></tr></table></figure>
<div><br><style><br>    .dataframe thead tr:only-child th {<br>        text-align: right;<br>    }<br><br>    .dataframe thead th {<br>        text-align: left;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>长（米）</th><br>      <th>高（米）</th><br>      <th>翼展（米）</th><br>      <th>巡航速度（千米/时）</th><br>      <th>航程</th><br>      <th>坠机时间/year</th><br>      <th>坠落时间/month</th><br>      <th>坠落时间/day</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>46.60</td><br>      <td>14.760000</td><br>      <td>50.50</td><br>      <td>750.000000</td><br>      <td>4900</td><br>      <td>2016</td><br>      <td>7</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>39.47</td><br>      <td>12.300000</td><br>      <td>35.90</td><br>      <td>839.000000</td><br>      <td>6570</td><br>      <td>2019</td><br>      <td>10</td><br>      <td>3</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>29.13</td><br>      <td>8.190000</td><br>      <td>28.91</td><br>      <td>800.000000</td><br>      <td>2100</td><br>      <td>2011</td><br>      <td>3</td><br>      <td>15</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>27.20</td><br>      <td>7.650000</td><br>      <td>27.05</td><br>      <td>511.000000</td><br>      <td>2092</td><br>      <td>2010</td><br>      <td>11</td><br>      <td>4</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>22.25</td><br>      <td>7.490000</td><br>      <td>25.91</td><br>      <td>491.000000</td><br>      <td>2038</td><br>      <td>2009</td><br>      <td>2</td><br>      <td>12</td><br>    </tr><br>    <tr><br>      <th>5</th><br>      <td>8.54</td><br>      <td>2.440000</td><br>      <td>12.29</td><br>      <td>56.000000</td><br>      <td>40</td><br>      <td>1908</td><br>      <td>9</td><br>      <td>17</td><br>    </tr><br>    <tr><br>      <th>6</th><br>      <td>23.78</td><br>      <td>8.750000</td><br>      <td>29.20</td><br>      <td>470.000000</td><br>      <td>2500</td><br>      <td>2009</td><br>      <td>6</td><br>      <td>8</td><br>    </tr><br>    <tr><br>      <th>7</th><br>      <td>10.86</td><br>      <td>4.180000</td><br>      <td>14.94</td><br>      <td>257.000000</td><br>      <td>1400</td><br>      <td>2009</td><br>      <td>6</td><br>      <td>7</td><br>    </tr><br>    <tr><br>      <th>8</th><br>      <td>58.82</td><br>      <td>17.390000</td><br>      <td>60.30</td><br>      <td>502.956522</td><br>      <td>13400</td><br>      <td>2009</td><br>      <td>6</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>9</th><br>      <td>23.80</td><br>      <td>8.580000</td><br>      <td>29.30</td><br>      <td>440.000000</td><br>      <td>2500</td><br>      <td>2009</td><br>      <td>5</td><br>      <td>26</td><br>    </tr><br>    <tr><br>      <th>10</th><br>      <td>29.80</td><br>      <td>11.600000</td><br>      <td>40.40</td><br>      <td>540.000000</td><br>      <td>3800</td><br>      <td>2009</td><br>      <td>5</td><br>      <td>20</td><br>    </tr><br>    <tr><br>      <th>11</th><br>      <td>30.53</td><br>      <td>11.000000</td><br>      <td>28.00</td><br>      <td>430.000000</td><br>      <td>4800</td><br>      <td>2009</td><br>      <td>4</td><br>      <td>29</td><br>    </tr><br>    <tr><br>      <th>12</th><br>      <td>12.70</td><br>      <td>4.270000</td><br>      <td>15.90</td><br>      <td>341.000000</td><br>      <td>1680</td><br>      <td>2009</td><br>      <td>4</td><br>      <td>17</td><br>    </tr><br>    <tr><br>      <th>13</th><br>      <td>11.00</td><br>      <td>3.200000</td><br>      <td>15.87</td><br>      <td>220.000000</td><br>      <td>926</td><br>      <td>2009</td><br>      <td>4</td><br>      <td>17</td><br>    </tr><br>    <tr><br>      <th>14</th><br>      <td>31.00</td><br>      <td>8.229357</td><br>      <td>26.34</td><br>      <td>747.000000</td><br>      <td>3340</td><br>      <td>2009</td><br>      <td>4</td><br>      <td>9</td><br>    </tr><br>    <tr><br>      <th>15</th><br>      <td>25.06</td><br>      <td>8.720000</td><br>      <td>29.00</td><br>      <td>460.000000</td><br>      <td>2600</td><br>      <td>2009</td><br>      <td>4</td><br>      <td>6</td><br>    </tr><br>    <tr><br>      <th>16</th><br>      <td>61.60</td><br>      <td>17.650000</td><br>      <td>51.97</td><br>      <td>502.956522</td><br>      <td>6652</td><br>      <td>2009</td><br>      <td>3</td><br>      <td>23</td><br>    </tr><br>    <tr><br>      <th>17</th><br>      <td>14.40</td><br>      <td>4.260000</td><br>      <td>16.28</td><br>      <td>528.000000</td><br>      <td>3417</td><br>      <td>2009</td><br>      <td>3</td><br>      <td>22</td><br>    </tr><br>    <tr><br>      <th>18</th><br>      <td>46.59</td><br>      <td>14.760000</td><br>      <td>50.50</td><br>      <td>502.956522</td><br>      <td>5000</td><br>      <td>2009</td><br>      <td>3</td><br>      <td>9</td><br>    </tr><br>    <tr><br>      <th>19</th><br>      <td>32.80</td><br>      <td>8.400000</td><br>      <td>28.40</td><br>      <td>502.956522</td><br>      <td>2040</td><br>      <td>2009</td><br>      <td>2</td><br>      <td>12</td><br>    </tr><br>    <tr><br>      <th>20</th><br>      <td>16.90</td><br>      <td>5.120000</td><br>      <td>16.31</td><br>      <td>874.000000</td><br>      <td>4348</td><br>      <td>2009</td><br>      <td>2</td><br>      <td>7</td><br>    </tr><br>    <tr><br>      <th>21</th><br>      <td>15.10</td><br>      <td>4.920000</td><br>      <td>15.33</td><br>      <td>341.000000</td><br>      <td>1964</td><br>      <td>2009</td><br>      <td>2</td><br>      <td>7</td><br>    </tr><br>    <tr><br>      <th>22</th><br>      <td>37.57</td><br>      <td>11.760000</td><br>      <td>34.10</td><br>      <td>502.956522</td><br>      <td>5700</td><br>      <td>2009</td><br>      <td>1</td><br>      <td>15</td><br>    </tr><br>    <tr><br>      <th>23</th><br>      <td>11.74</td><br>      <td>4.930000</td><br>      <td>14.94</td><br>      <td>308.000000</td><br>      <td>1030</td><br>      <td>2008</td><br>      <td>11</td><br>      <td>6</td><br>    </tr><br>    <tr><br>      <th>24</th><br>      <td>33.10</td><br>      <td>10.530000</td><br>      <td>38.00</td><br>      <td>670.000000</td><br>      <td>3600</td><br>      <td>2008</td><br>      <td>11</td><br>      <td>13</td><br>    </tr><br>    <tr><br>      <th>25</th><br>      <td>8.61</td><br>      <td>2.832000</td><br>      <td>10.97</td><br>      <td>262.000000</td><br>      <td>1352</td><br>      <td>2008</td><br>      <td>11</td><br>      <td>8</td><br>    </tr><br>    <tr><br>      <th>26</th><br>      <td>17.60</td><br>      <td>4.300000</td><br>      <td>14.50</td><br>      <td>895.000000</td><br>      <td>4074</td><br>      <td>2008</td><br>      <td>11</td><br>      <td>4</td><br>    </tr><br>    <tr><br>      <th>27</th><br>      <td>15.77</td><br>      <td>5.940000</td><br>      <td>19.81</td><br>      <td>338.000000</td><br>      <td>1344</td><br>      <td>2008</td><br>      <td>10</td><br>      <td>8</td><br>    </tr><br>    <tr><br>      <th>28</th><br>      <td>17.90</td><br>      <td>4.500000</td><br>      <td>13.40</td><br>      <td>502.956522</td><br>      <td>4461</td><br>      <td>2008</td><br>      <td>9</td><br>      <td>19</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#预处理，将x、y分为train、test，73开</span></span><br><span class="line">x_train, X_test, y_train, Y_test = train_test_split(x,y,test_size=<span class="number">0.3</span>,random_state=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#判断类型</span></span><br><span class="line">isinstance(y_train, pd.Series)</span><br><span class="line">y_train.dtypes</span><br><span class="line"><span class="comment">#压缩y_train</span></span><br><span class="line">y_train = np.squeeze(y_train)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#引入GBC、网格搜索、metrics(模型评估)</span></span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> GradientBoostingClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.grid_search <span class="keyword">import</span> GridSearchCV</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#‘网格搜索’GBC的参数n_estimators，范围为（20，80），找到最佳，为20，Accuracy为0.888888</span></span><br><span class="line">max_score = <span class="number">-70</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>,<span class="number">80</span>):</span><br><span class="line">    max_i = <span class="number">20</span></span><br><span class="line">    </span><br><span class="line">    gbc = GradientBoostingClassifier(random_state=<span class="number">10</span>,n_estimators=i)</span><br><span class="line">    gbc.fit(x_train,y_train)</span><br><span class="line">    y_pred = gbc.predict(X_test)</span><br><span class="line">    score = metrics.accuracy_score(Y_test, y_pred)</span><br><span class="line">    <span class="comment">#print(score&gt;max_score)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#print(max_score)</span></span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">79</span>):</span><br><span class="line">        print(max_i)</span><br><span class="line">        print(max_score)</span><br><span class="line">    <span class="keyword">if</span>(score &gt; max_score):</span><br><span class="line">        max_i = i</span><br><span class="line">        max_score = score</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="comment">#calc(y_pred,Y_test)</span></span><br></pre></td></tr></table></figure>
<pre><code>20
0.888888888889
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#‘网格搜索’GBC的参数min_samples_split，范围为（100，801），找到最佳，为100，Accuracy为0.888888</span></span><br><span class="line">max_score1 = <span class="number">-70</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>,<span class="number">801</span>):</span><br><span class="line">    max_i = <span class="number">100</span></span><br><span class="line">    </span><br><span class="line">    gbc = GradientBoostingClassifier(random_state=<span class="number">10</span>,n_estimators=<span class="number">20</span>,min_samples_split=i)</span><br><span class="line">    gbc.fit(x_train,y_train)</span><br><span class="line">    y_pred = gbc.predict(X_test)</span><br><span class="line">    score = metrics.accuracy_score(Y_test, y_pred)</span><br><span class="line">    <span class="comment">#print(score&gt;max_score)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#print(max_score)</span></span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">800</span>):</span><br><span class="line">        print(max_i)</span><br><span class="line">        print(max_score1)</span><br><span class="line">    <span class="keyword">if</span>(score &gt; max_score1):</span><br><span class="line">        max_i = i</span><br><span class="line">        max_score1 = score</span><br><span class="line">        </span><br><span class="line"><span class="comment">#gsearch1.grid_scores_, gsearch1.best_params_, gsearch1.best_score_</span></span><br></pre></td></tr></table></figure>
<pre><code>100
0.888888888889
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#‘网格搜索’GBC的参数min_samples_leaf，范围为（20，101），无最佳，Accuracy为0.888888</span></span><br><span class="line">max_score2 = <span class="number">-70</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20</span>,<span class="number">101</span>):</span><br><span class="line">    max_i = <span class="number">20</span></span><br><span class="line">    </span><br><span class="line">    gbc = GradientBoostingClassifier(random_state=<span class="number">10</span>,n_estimators=<span class="number">20</span>,min_samples_split=<span class="number">100</span>,min_samples_leaf=i)</span><br><span class="line">    gbc.fit(x_train,y_train)</span><br><span class="line">    y_pred = gbc.predict(X_test)</span><br><span class="line">    score = metrics.accuracy_score(Y_test, y_pred)</span><br><span class="line">    <span class="comment">#print(score&gt;max_score)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#print(max_score)</span></span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">100</span>):</span><br><span class="line">        print(max_i)</span><br><span class="line">        print(max_score2)</span><br><span class="line">    <span class="keyword">if</span>(score &gt; max_score2):</span><br><span class="line">        max_i = i</span><br><span class="line">        max_score1 = score</span><br></pre></td></tr></table></figure>
<pre><code>20
-70
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#最终参数</span></span><br><span class="line">gbc = GradientBoostingClassifier(random_state=<span class="number">10</span>,n_estimators=<span class="number">20</span>,min_samples_split=<span class="number">100</span>)</span><br><span class="line"><span class="comment">#拟合</span></span><br><span class="line">gbc.fit(x_train,y_train)</span><br><span class="line"><span class="comment">#评估判断</span></span><br><span class="line">y_pred = gbc.predict(X_test)</span><br><span class="line"><span class="comment">#精准度</span></span><br><span class="line">print(<span class="string">"Accuracy : %f"</span>%metrics.accuracy_score(Y_test, y_pred))</span><br></pre></td></tr></table></figure>
<pre><code>Accuracy : 0.888889
</code></pre>
    </div>
    </article>
</div>

    <div class="_toc">
        <strong class="toc-title">
        Contents
        </strong>
        <div class="toc-content">
            
        </div>
    </div>

</section>


    <nav class="post-nav">
        
            <div class="page-tags">
                
                    <a href="/tags/Web/">Web</a>
                
            </div>
        
    </nav>



    <nav class="paginator">
        
        
            <a class="next" href="/2019/02/18/hello/">
                
                <span class="prev-text">Hello World</span>
                <i class="iconfont icon-right"></i>
            </a>
        
    </nav>


            </main>
            <div class="copyright">
  <div class="text">Powered By
    <a href="https://hexo.io/">Hexo</a> | Theme <a href="https://github.com/zjx137/hexo-theme-Tsu">Tsu</a> &copy 2019
  </div>
</div>

        </div>
    <div class="back-to-top" id="back-to-top">
            <i class="iconfont icon-up"></i>
    </div>
        
    </body>
    <script src="/js/jquery-3.3.1.min.js"></script>
    <script src="/js/back-to-top.js"></script>
    <script src="/js/scroll.js"></script>
    <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": { 
        preferredFont: "TeX", 
        availableFonts: ["STIX","TeX"], 
        linebreaks: { automatic:true }, 
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) 
    },
    tex2jax: { 
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ], 
        processEscapes: true, 
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {  
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, 
        Macros: { href: "{}" } 
    },
    messageStyle: "none"
    }); 
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

</html>
